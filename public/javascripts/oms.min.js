(function(){/*
 OverlappingMarkerSpiderfier
 https://github.com/jawj/OverlappingMarkerSpiderfier
 Copyright (c) 2011 - 2012 George MacKerron
 Released under the MIT licence: http://opensource.org/licenses/mit-license
 Note: The Google Maps API v3 must be included *before* this code
*/
var i=null;
(function(){var r,s=Object.prototype.hasOwnProperty,t=Array.prototype.slice;if(((r=this.google)!=i?r.maps:void 0)!=i)this.OverlappingMarkerSpiderfier=function(){function n(c,d){var a,e,f,b,g=this;this.map=c;d==i&&(d={});for(a in d)s.call(d,a)&&(e=d[a],this[a]=e);this.m=new this.constructor.c(this.map);this.i();this.b={};b=["click","zoom_changed","maptypeid_changed"];for(e=0,f=b.length;e<f;e++)a=b[e],k.addListener(this.map,a,function(){return g.unspiderfy()})}var k,o,p,l,j,b,q;b=n.prototype;b.VERSION=
"0.2.4";o=google.maps;k=o.event;j=o.MapTypeId;q=2*Math.PI;b.keepSpiderfied=!1;b.markersWontHide=!1;b.markersWontMove=!1;b.nearbyDistance=20;b.circleSpiralSwitchover=9;b.circleFootSeparation=23;b.circleStartAngle=q/12;b.spiralFootSeparation=26;b.spiralLengthStart=11;b.spiralLengthFactor=4;b.spiderfiedZIndex=1E3;b.usualLegZIndex=10;b.highlightedLegZIndex=20;b.legWeight=1.5;b.legColors={usual:{},highlighted:{}};l=b.legColors.usual;p=b.legColors.highlighted;l[j.HYBRID]=l[j.SATELLITE]="#fff";p[j.HYBRID]=
p[j.SATELLITE]="#f00";l[j.TERRAIN]=l[j.ROADMAP]="#444";p[j.TERRAIN]=p[j.ROADMAP]="#f00";b.i=function(){this.a=[];this.f=[]};b.addMarker=function(c){var d,a=this;d=[k.addListener(c,"click",function(){return a.B(c)})];this.markersWontHide||d.push(k.addListener(c,"visible_changed",function(){return a.k(c,!1)}));this.markersWontMove||d.push(k.addListener(c,"position_changed",function(){return a.k(c,!0)}));this.f.push(d);this.a.push(c);return this};b.k=function(c,d){if(c._omsData!=i&&(d||!c.getVisible())&&
!(this.p!=i||this.q!=i))return this.F(d?c:i)};b.getMarkers=function(){return this.a.slice(0,this.a.length)};b.removeMarker=function(c){var d,a,e,f;c._omsData!=i&&this.unspiderfy();c=this.h(this.a,c);if(!(0>c)){a=this.f.splice(c,1)[0];for(e=0,f=a.length;e<f;e++)d=a[e],k.removeListener(d);this.a.splice(c,1);return this}};b.clearMarkers=function(){var c,d,a,e,f,b,g;this.unspiderfy();g=this.f;for(a=0,f=g.length;a<f;a++){d=g[a];for(e=0,b=d.length;e<b;e++)c=d[e],k.removeListener(c)}this.i();return this};
b.addListener=function(c,d){var a,e;((e=(a=this.b)[c])!=i?e:a[c]=[]).push(d);return this};b.removeListener=function(c,d){var a;a=this.h(this.b[c],d);0>a||this.b[c].splice(a,1);return this};b.clearListeners=function(c){this.b[c]=[];return this};b.trigger=function(){var g;var c,d,a,e,f,b;d=arguments[0];c=2<=arguments.length?t.call(arguments,1):[];g=(a=this.b[d])!=i?a:[],d=g;b=[];for(e=0,f=d.length;e<f;e++)a=d[e],b.push(a.apply(i,c));return b};b.r=function(c,d){var a,e,f,b,g;b=this.circleFootSeparation*
(2+c)/q;e=q/c;g=[];for(f=0;0<=c?f<c:f>c;0<=c?f++:f--)a=this.circleStartAngle+f*e,g.push(new o.Point(d.x+b*Math.cos(a),d.y+b*Math.sin(a)));return g};b.s=function(c,d){var a,e,b,h,g;b=this.spiralLengthStart;a=0;g=[];for(e=0;0<=c?e<c:e>c;0<=c?e++:e--)a+=this.spiralFootSeparation/b+5.0E-4*e,h=new o.Point(d.x+b*Math.cos(a),d.y+b*Math.sin(a)),b+=q*this.spiralLengthFactor/a,g.push(h);return g};b.B=function(c){var d,a,b,f,h,g,k,m,j;d=c._omsData!=i;(!d||!this.keepSpiderfied)&&this.unspiderfy();if(d)return this.trigger("click",
c);f=[];h=[];g=this.nearbyDistance*this.nearbyDistance;b=this.j(c.position);j=this.a;for(k=0,m=j.length;k<m;k++)d=j[k],d.getVisible()&&d.map!=i&&(a=this.j(d.position),this.n(a,b)<g?f.push({v:d,l:a}):h.push(d));return 1===f.length?this.trigger("click",c):this.C(f,h)};b.u=function(c){var d=this;return{d:function(){return c._omsData.e.setOptions({strokeColor:d.legColors.highlighted[d.map.mapTypeId],zIndex:d.highlightedLegZIndex})},g:function(){return c._omsData.e.setOptions({strokeColor:d.legColors.usual[d.map.mapTypeId],
zIndex:d.usualLegZIndex})}}};b.C=function(c,d){var a,b,f,h,g,j,m,n,p,l;this.p=!0;l=c.length;a=this.z(function(){var a,d,b;b=[];for(a=0,d=c.length;a<d;a++)n=c[a],b.push(n.l);return b}());h=l>=this.circleSpiralSwitchover?this.s(l,a).reverse():this.r(l,a);a=function(){var a,d,l,n=this;l=[];for(a=0,d=h.length;a<d;a++){f=h[a];b=this.A(f);p=this.w(c,function(a){return n.n(a.l,f)});m=p.v;j=new o.Polyline({map:this.map,path:[m.position,b],strokeColor:this.legColors.usual[this.map.mapTypeId],strokeWeight:this.legWeight,
zIndex:this.usualLegZIndex});m._omsData={D:m.position,e:j};if(this.legColors.highlighted[this.map.mapTypeId]!==this.legColors.usual[this.map.mapTypeId])g=this.u(m),m._omsData.t={d:k.addListener(m,"mouseover",g.d),g:k.addListener(m,"mouseout",g.g)};m.setPosition(b);m.setZIndex(Math.round(this.spiderfiedZIndex+f.y));l.push(m)}return l}.call(this);delete this.p;this.o=!0;return this.trigger("spiderfy",a,d)};b.unspiderfy=function(c){var d,a,b,f,h,g,j;c==i&&(c=i);if(this.o!=i){this.q=!0;f=[];b=[];j=this.a;
for(h=0,g=j.length;h<g;h++)a=j[h],a._omsData!=i?(a._omsData.e.setMap(i),a!==c&&a.setPosition(a._omsData.D),a.setZIndex(i),d=a._omsData.t,d!=i&&(k.removeListener(d.d),k.removeListener(d.g)),delete a._omsData,f.push(a)):b.push(a);delete this.q;delete this.o;this.trigger("unspiderfy",f,b);return this}};b.n=function(c,b){var a,e;a=c.x-b.x;e=c.y-b.y;return a*a+e*e};b.z=function(c){var b,a,e,f,h;a=e=0;for(f=0,h=c.length;f<h;f++)b=c[f],a+=b.x,e+=b.y;c=c.length;return new o.Point(a/c,e/c)};b.j=function(c){return this.m.getProjection().fromLatLngToDivPixel(c)};
b.A=function(c){return this.m.getProjection().fromDivPixelToLatLng(c)};b.w=function(c,b){var a,e,f,h,g;for(f=0,g=c.length;f<g;f++)if(h=c[f],h=b(h),!("undefined"!==typeof a&&a!==i)||h<e)e=h,a=f;return c.splice(a,1)[0]};b.h=function(c,b){var a,e,f;if(c.indexOf!=i)return c.indexOf(b);for(a=0,f=c.length;a<f;a++)if(e=c[a],e===b)return a;return-1};n.c=function(b){return this.setMap(b)};n.c.prototype=new o.OverlayView;n.c.prototype.draw=function(){};return n}()}).call(this);}).call(this);
/* Thu 1 Mar 2012 15:56:19 GMT */
